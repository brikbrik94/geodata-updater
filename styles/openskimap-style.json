{
  "version": 8,
  "name": "OpenSkiMap Overlay",
  "glyphs": "{TILES_BASE_URL}/assets/fonts/{fontstack}/{range}.pbf",
  "sources": {
    "ski_source": {
      "type": "vector",
      "url": "pmtiles://{TILES_BASE_URL}/openskimap.pmtiles",
      "attribution": "OpenSkiMap.org"
    }
  },
  "layers": [
    {
      "id": "ski-areas",
      "type": "fill",
      "source": "ski_source",
      "source-layer": "areas_poly",
      "paint": { "fill-color": "#7fc97f", "fill-opacity": 0.1 }
    },
    {
      "id": "ski-runs-alpine",
      "type": "line",
      "source": "ski_source",
      "source-layer": "runs_line",
      "filter": ["!=", ["get", "uses"], "nordic"],
      "layout": { "line-join": "round", "line-cap": "round" },
      "paint": {
        "line-width": ["interpolate", ["linear"], ["zoom"], 10, 1.5, 15, 5],
        "line-color": [
          "match",
          ["get", "difficulty"],
          "novice", "#00ff00",
          "easy", "#0000ff",
          "intermediate", "#ff0000",
          "advanced", "#000000",
          "expert", "#ff00ff",
          "#888"
        ]
      }
    },
    {
      "id": "ski-runs-nordic",
      "type": "line",
      "source": "ski_source",
      "source-layer": "runs_line",
      "filter": ["==", ["get", "uses"], "nordic"],
      "layout": { "line-join": "round" },
      "paint": { "line-width": 2, "line-color": "#ff6600", "line-dasharray": [3, 2] }
    },
    {
      "id": "ski-lifts-line",
      "type": "line",
      "source": "ski_source",
      "source-layer": "lifts",
      "paint": {
        "line-color": "#333",
        "line-width": ["match", ["get", "lift_type"], "cable_car", 2, 1],
        "line-dasharray": ["match", ["get", "lift_type"], "funicular", [1, 0], [4, 1]]
      }
    },
    {
      "id": "ski-lifts-icons",
      "type": "symbol",
      "source": "ski_source",
      "source-layer": "lifts",
      "minzoom": 13,
      "layout": {
        "symbol-placement": "line",
        "symbol-spacing": 150,
        "icon-image": [
          "match",
          ["get", "lift_type"],
          "gondola", "ski-gondola",
          "cable_car", "ski-cable-car",
          "chair_lift", "ski-chair-lift",
          "funicular", "ski-funicular",
          "ski-drag-lift"
        ],
        "icon-size": 0.7,
        "icon-allow-overlap": false
      }
    },
    {
      "id": "ski-labels",
      "type": "symbol",
      "source": "ski_source",
      "source-layer": "runs_line",
      "minzoom": 14,
      "layout": {
        "text-field": ["get", "name"],
        "text-font": ["Arial Regular"],
        "text-size": 10,
        "symbol-placement": "line",
        "text-offset": [0, 1]
      },
      "paint": { "text-color": "#333", "text-halo-color": "#fff", "text-halo-width": 1.5 }
    }
  ]
}
